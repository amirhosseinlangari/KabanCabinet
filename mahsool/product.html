<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#f1c68e">
    <meta name="description" content="Ø¬Ø²Ø¦ÛŒØ§Øª Ù…Ø­ØµÙˆÙ„Ø§Øª Ú©Ø§Ø¨ÛŒÙ†Øª Ú©Ø§Ø¨Ø§Ù† - Ú©ÛŒÙÛŒØªØŒ Ø²ÛŒØ¨Ø§ÛŒÛŒ Ùˆ Ø·Ø±Ø§Ø­ÛŒ Ù…Ù†Ø­ØµØ± Ø¨Ù‡ ÙØ±Ø¯">
    <meta name="keywords" content="Ú©Ø§Ø¨ÛŒÙ†Øª Ú©Ø§Ø¨Ø§Ù†ØŒ Ù…Ø­ØµÙˆÙ„Ø§Øª Ú©Ø§Ø¨ÛŒÙ†ØªØŒ Ú©Ø§Ø¨ÛŒÙ†Øª Ø¢Ø´Ù¾Ø²Ø®Ø§Ù†Ù‡ØŒ Ø¬Ø²Ø¦ÛŒØ§Øª Ù…Ø­ØµÙˆÙ„ØŒ Ø®Ø±ÛŒØ¯ Ú©Ø§Ø¨ÛŒÙ†Øª">
    <title>Ø¬Ø²Ø¦ÛŒØ§Øª Ù…Ø­ØµÙˆÙ„ | Ú©Ø§Ø¨ÛŒÙ†Øª Ú©Ø§Ø¨Ø§Ù†</title>
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="css/product.css">
    <link rel="icon" href="../icon_kaban.ico" type="image/x-icon">
</head>
<body>
    <header class="main-header">
        <div class="nav-logo">
            <img src="../assets/Photo/Ù†Ù…Ø§Ø¯Ú© Ú©Ø§Ø¨Ø§Ù†.png" alt="Ù„ÙˆÚ¯Ùˆ Ú©Ø§Ø¨Ø§Ù†" class="logo" width="50" height="50">
            <h1>Ú©Ø§Ø¨ÛŒÙ†Øª Ú©Ø§Ø¨Ø§Ù†</h1>
        </div>
        <button class="menu-toggle" aria-label="Ù…Ù†Ùˆ">
            <span></span>
            <span></span>
            <span></span>
        </button>
        <div class="overlay"></div>
        <nav class="nav-container">
            <ul class="nav-menu">
                <li><a href="../index.html">ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ</a></li>
                <li class="dropdown-cabinet">
                    <a href="cabinet.html">Ù…Ø­ØµÙˆÙ„Ø§Øª</a>
                    <ul class="submenu">
                        <li><a href="cabinet.html">Ú©Ø§Ø¨ÛŒÙ†Øª</a></li>
                        <li><a href="accessories.html">Ù„ÙˆØ§Ø²Ù… Ø¬Ø§Ù†Ø¨ÛŒ</a></li>
                        <li><a href="hardware.html">ÛŒØ±Ø§Ù‚â€ŒØ¢Ù„Ø§Øª</a></li>
                    </ul>
                </li>
                <li><a href="../3d-designs/index.html">Ø·Ø±Ø§Ø­ÛŒ Ø³Ù‡ Ø¨Ø¹Ø¯ÛŒ</a></li>
                <li><a href="../portfolio/index.html">Ù†Ù…ÙˆÙ†Ù‡ Ú©Ø§Ø±</a></li>
                <li><a href="../weblog/index.html">ÙˆØ¨Ù„Ø§Ú¯</a></li>
                <li><a href="../about-us/index.html">Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù…Ø§</a></li>
                <li class="dark-mode-li mobile-only">
                    <label for="mobileDarkMode" class="switch">
                        <input type="checkbox" id="mobileDarkMode">
                        <span class="slider round"></span>
                    </label>
                    <span>Ø­Ø§Ù„Øª Ø´Ø¨</span>
                </li>
            </ul>
        </nav>
        <div class="header-actions">
            <button id="darkModeToggle" class="dark-mode-toggle desktop-only" aria-label="ØªØºÛŒÛŒØ± Ø±Ù†Ú¯ Ø²Ù…ÛŒÙ†Ù‡">
                <span class="moon">ğŸŒ™</span>
                <span class="sun">â˜€ï¸</span>
            </button>
            <a href="../checkout.html" class="cart-icon" aria-label="Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯">
                <div class="cart-count">0</div>
                <span class="cart-emoji">ğŸ›’</span>
            </a>
            <a href="../account/login.html" class="user-icon" aria-label="Ø­Ø³Ø§Ø¨ Ú©Ø§Ø±Ø¨Ø±ÛŒ">
                <span class="user-emoji">ğŸ‘¤</span>
            </a>
        </div>
    </header>

    <!-- Ù…Ø­ØªÙˆØ§ÛŒ Ø§ØµÙ„ÛŒ ØµÙØ­Ù‡ - Ø§ÛŒÙ† Ø¨Ø®Ø´ Ø¨Ø§ API Ù¾Ø± Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯ -->
    <main class="container">
        <!-- Ù†Ù…Ø§ÛŒØ´Ú¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ -->
        <div class="loading-container">
            <div class="spinner"></div>
            <p>Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø­ØµÙˆÙ„...</p>
        </div>
        
        <!-- Ú©Ø§Ù†ØªÛŒÙ†Ø± Ø§ØµÙ„ÛŒ Ù…Ø­ØµÙˆÙ„ - Ø¨Ø§ JavaScript Ù¾Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
        <div class="product-detail-container" style="display: none;">
            <!-- Ù†Ù…Ø§ÛŒØ´ Ø®Ø·Ø§ -->
            <div class="error-message" style="display: none;">
                <h2>Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø­ØµÙˆÙ„</h2>
                <p>Ù…ØªØ£Ø³ÙØ§Ù†Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø­ØµÙˆÙ„ ÛŒØ§ÙØª Ù†Ø´Ø¯.</p>
                <a href="cabinet.html" class="btn btn-primary">Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù„ÛŒØ³Øª Ù…Ø­ØµÙˆÙ„Ø§Øª</a>
            </div>
        </div>

        <!-- Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ú©Ù„Ø§Ø³ products-container -->
        <div class="products-container">
            <!-- Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª Ø§ÛŒÙ†Ø¬Ø§ Ù‚Ø±Ø§Ø± Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ø¯ -->
        </div>
    </main>

    <footer class="main-footer">
        <div class="footer-container">
            <div class="footer-logo-container">
                <div class="footer-logo-wrapper">
                    <img src="../assets/Photo/Ù†Ù…Ø§Ø¯Ú© Ú©Ø§Ø¨Ø§Ù†.png" alt="Ù„ÙˆÚ¯Ùˆ Ú©Ø§Ø¨Ø§Ù†" class="footer-logo" width="65" height="65">
                </div>
                <div class="footer-logo-text">Ú©Ø§Ø¨ÛŒÙ†Øª Ú©Ø§Ø¨Ø§Ù†</div>
                <div class="social-icons">
                    <a href="#" class="social-icon" aria-label="Ø§ÛŒÙ†Ø³ØªØ§Ú¯Ø±Ø§Ù…"><i>ğŸ“¸</i></a>
                    <a href="#" class="social-icon" aria-label="ØªÙ„Ú¯Ø±Ø§Ù…"><i>ğŸ“¬</i></a>
                    <a href="#" class="social-icon" aria-label="ÙˆØ§ØªØ³Ø§Ù¾"><i>ğŸ“±</i></a>
                </div>
            </div>
            
            <div class="footer-links-container">
                <div class="footer-address">
                    <h4>Ø¢Ø¯Ø±Ø³ Ù…Ø§</h4>
                    <p><i class="address-icon">ğŸ“</i>ØªÙ‡Ø±Ø§Ù†ØŒ Ø®ÛŒØ§Ø¨Ø§Ù† Ø³ØªØ§Ø±Ø®Ø§Ù†ØŒ Ø¨ÙˆØ³ØªØ§Ù† Ø³ÙˆÙ…ØŒ Ù¾Ù„Ø§Ú© Û±Û²ØŒ Ú©Ø§Ø¨ÛŒÙ†Øª Ú©Ø§Ø¨Ø§Ù†</p>
                    <p><i class="address-icon">ğŸ•’</i>Ø³Ø§Ø¹Ø§Øª Ú©Ø§Ø±ÛŒ: Ø´Ù†Ø¨Ù‡ ØªØ§ Ù¾Ù†Ø¬Ø´Ù†Ø¨Ù‡ Ø§Ø² Ø³Ø§Ø¹Øª Û¸ ØµØ¨Ø­ ØªØ§ Û¸ Ø´Ø¨</p>
                </div>
                <div class="footer-links">
                    <h4>Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ù…Ø§</h4>
                    <ul>
                        <li><a href="#">ØªÙ…Ø§Ø³ Ø¨Ø§ Ù…Ø§</a></li>
                        <li><a href="../about-us/index.html">Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù…Ø§</a></li>
                        <li class="footer-contact-item"><i class="footer-icon">ğŸ“±</i><span>Û°Û¹Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹</span></li>
                        <li class="footer-contact-item"><i class="footer-icon">ğŸ“§</i><span>info@kabancabinet.ir</span></li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p class="copyright">Â© Û±Û´Û°Û³ Ú©Ø§Ø¨ÛŒÙ†Øª Ú©Ø§Ø¨Ø§Ù† - ØªÙ…Ø§Ù…ÛŒ Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸ Ø§Ø³Øª</p>
        </div>
    </footer>

    <script src="../scripts/main.js" defer></script>
    <script src="../scripts/sw-register.js" defer></script>
    <script src="../scripts/cart.js" defer></script>
    <script src="../scripts/orderAPI.js" defer></script>
    <script>
    // Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø³Ø±Ø§Ø³Ø±ÛŒ
    let productId, productData;

    /**
     * Ù†Ù…Ø§ÛŒØ´ Ø¬Ø²Ø¦ÛŒØ§Øª Ù…Ø­ØµÙˆÙ„ Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯Ù‡ Ø§Ø² API
     */
    document.addEventListener('DOMContentLoaded', function() {
        // Ø¯Ø±ÛŒØ§ÙØª Ø´Ù†Ø§Ø³Ù‡ Ù…Ø­ØµÙˆÙ„ Ø§Ø² URL
        const urlParams = new URLSearchParams(window.location.search);
        productId = urlParams.get('id');
        
        if (!productId) {
            showError('Ø´Ù†Ø§Ø³Ù‡ Ù…Ø­ØµÙˆÙ„ Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª');
            return;
        }
        
        // Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø­ØµÙˆÙ„ Ø§Ø² API
        fetchProductDetails(productId);
    });
    
    /**
     * Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø­ØµÙˆÙ„ Ø§Ø² API Ø¨Ú©â€ŒØ§Ù†Ø¯
     */
    function fetchProductDetails(id) {
        fetch(`http://localhost:3000/api/products/${id}`)
            .then(response => {
                if (!response.ok) {
                    throw new Error(`Ø®Ø·Ø§ÛŒ HTTP: ${response.status}`);
                }
                return response.json();
            })
            .then(result => {
                if (!result.success || !result.data) {
                    throw new Error('Ø¯Ø§Ø¯Ù‡ Ù…Ø­ØµÙˆÙ„ Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª');
                }
                
                // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø­ØµÙˆÙ„
                productData = result.data;
                
                // Ù†Ù…Ø§ÛŒØ´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø­ØµÙˆÙ„
                displayProductDetails(productData);
            })
            .catch(error => {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø­ØµÙˆÙ„:', error);
                showError(error.message);
            });
    }
    
    /**
     * Ù†Ù…Ø§ÛŒØ´ Ø®Ø·Ø§ Ø¯Ø± ØµÙØ­Ù‡
     */
    function showError(message) {
        // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ù†Ù…Ø§ÛŒØ´Ú¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ
        document.querySelector('.loading-container').style.display = 'none';
        
        // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù… Ø®Ø·Ø§
        const errorElement = document.querySelector('.error-message');
        const errorText = errorElement.querySelector('p');
        errorText.textContent = message || 'Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø­ØµÙˆÙ„';
        errorElement.style.display = 'block';
        
        // Ù†Ù…Ø§ÛŒØ´ Ú©Ø§Ù†ØªÛŒÙ†Ø± Ù…Ø­ØµÙˆÙ„
        document.querySelector('.product-detail-container').style.display = 'block';
    }
    
    /**
     * Ù†Ù…Ø§ÛŒØ´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø­ØµÙˆÙ„ Ø¯Ø± ØµÙØ­Ù‡
     */
    function displayProductDetails(product) {
        // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ù†Ù…Ø§ÛŒØ´Ú¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ
        document.querySelector('.loading-container').style.display = 'none';
        
        // ØªÙ†Ø¸ÛŒÙ… Ø¹Ù†ÙˆØ§Ù† ØµÙØ­Ù‡
        document.title = `${product.name} | Ú©Ø§Ø¨ÛŒÙ†Øª Ú©Ø§Ø¨Ø§Ù†`;
        
        // Ø§ÛŒØ¬Ø§Ø¯ HTML Ø¬Ø²Ø¦ÛŒØ§Øª Ù…Ø­ØµÙˆÙ„
        const detailContainer = document.querySelector('.product-detail-container');
        
        // Ù…Ø­ØµÙˆÙ„ Ù…ÙˆØ¬ÙˆØ¯ Ø§Ø³Øª
        detailContainer.innerHTML = `
            <div class="product-bread-crumbs">
                <a href="../index.html">ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ</a>
                <span>></span>
                <a href="cabinet.html">Ù…Ø­ØµÙˆÙ„Ø§Øª</a>
                <span>></span>
                <a href="cabinet.html?category=${product.category}">${getCategoryName(product.category)}</a>
                <span>></span>
                <span>${product.name}</span>
            </div>
            
            <div class="product-main-details">
                <div class="product-gallery">
                    <div class="main-image">
                        <img src="${getProductImage(product)}" alt="${product.name}" id="mainProductImage">
                    </div>
                    ${getGalleryThumbnails(product)}
                </div>
                
                <div class="product-info">
                    <h1 class="product-title">${product.name}</h1>
                    
                    <div class="product-availability">
                        ${product.inStock 
                            ? '<span class="in-stock-badge">Ù…ÙˆØ¬ÙˆØ¯</span>' 
                            : '<span class="out-of-stock-badge">Ù†Ø§Ù…ÙˆØ¬ÙˆØ¯</span>'}
                    </div>
                    
                    <div class="product-description">
                        ${product.description}
                    </div>
                    
                    ${getProductFeatures(product)}
                    
                    ${getProductDimensions(product)}
                    
                    ${getProductColors(product)}
                    
                    ${getProductMaterials(product)}
                    
                    <div class="product-price-section">
                        <div class="product-price">${formatPrice(product.price)} ØªÙˆÙ…Ø§Ù†</div>
                        
                        <div class="product-actions">
                            <div class="quantity-selector">
                                <button class="quantity-decrease">-</button>
                                <input type="number" id="productQuantity" value="1" min="1" max="10">
                                <button class="quantity-increase">+</button>
                            </div>
                            
                            <button class="add-to-cart-btn" 
                                data-id="${product._id}"
                                data-name="${product.name}"
                                data-price="${product.price}"
                                data-image="${product.images?.[0] || '../assets/Photo/default-product.png'}"
                                ${!product.inStock ? 'disabled' : ''}>
                                ${product.inStock ? 'Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯' : 'Ù†Ø§Ù…ÙˆØ¬ÙˆØ¯'}
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="product-tabs">
                <div class="tab-buttons">
                    <button class="tab-btn active" data-tab="description">ØªÙˆØ¶ÛŒØ­Ø§Øª</button>
                    <button class="tab-btn" data-tab="details">Ù…Ø´Ø®ØµØ§Øª ÙÙ†ÛŒ</button>
                    <button class="tab-btn" data-tab="comments">Ù†Ø¸Ø±Ø§Øª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†</button>
                </div>
                
                <div class="tab-content">
                    <div class="tab-pane active" id="description">
                        <h2>ØªÙˆØ¶ÛŒØ­Ø§Øª Ù…Ø­ØµÙˆÙ„</h2>
                        <div class="tab-description">
                            ${product.description}
                        </div>
                    </div>
                    
                    <div class="tab-pane" id="details">
                        <h2>Ù…Ø´Ø®ØµØ§Øª ÙÙ†ÛŒ Ù…Ø­ØµÙˆÙ„</h2>
                        <table class="specs-table">
                            <tr>
                                <th>Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„</th>
                                <td>${product.name}</td>
                            </tr>
                            <tr>
                                <th>Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ</th>
                                <td>${getCategoryName(product.category)}</td>
                            </tr>
                            ${product.dimensions ? `
                            <tr>
                                <th>Ø§Ø¨Ø¹Ø§Ø¯</th>
                                <td>${product.dimensions.width || '-'} Ã— ${product.dimensions.height || '-'} Ã— ${product.dimensions.depth || '-'} Ø³Ø§Ù†ØªÛŒâ€ŒÙ…ØªØ±</td>
                            </tr>` : ''}
                            ${product.materials && product.materials.length > 0 ? `
                            <tr>
                                <th>Ø¬Ù†Ø³</th>
                                <td>${product.materials.join('ØŒ ')}</td>
                            </tr>` : ''}
                            ${product.colors && product.colors.length > 0 ? `
                            <tr>
                                <th>Ø±Ù†Ú¯â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯</th>
                                <td>${product.colors.join('ØŒ ')}</td>
                            </tr>` : ''}
                            <tr>
                                <th>ÙˆØ¶Ø¹ÛŒØª Ù…ÙˆØ¬ÙˆØ¯ÛŒ</th>
                                <td>${product.inStock ? 'Ù…ÙˆØ¬ÙˆØ¯' : 'Ù†Ø§Ù…ÙˆØ¬ÙˆØ¯'}</td>
                            </tr>
                        </table>
                    </div>
                    
                    <div class="tab-pane" id="comments">
                        <h2>Ù†Ø¸Ø±Ø§Øª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†</h2>
                        <div class="comments-container">
                            <p>Ù‡Ù†ÙˆØ² Ù†Ø¸Ø±ÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ù…Ø­ØµÙˆÙ„ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>
                            <button class="btn btn-outline">Ø§ÙØ²ÙˆØ¯Ù† Ù†Ø¸Ø±</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="related-products">
                <h2>Ù…Ø­ØµÙˆÙ„Ø§Øª Ù…Ø±ØªØ¨Ø·</h2>
                <div class="related-products-container">
                    <p>Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª Ù…Ø±ØªØ¨Ø·...</p>
                </div>
            </div>
        `;
        
        // Ù†Ù…Ø§ÛŒØ´ Ú©Ø§Ù†ØªÛŒÙ†Ø± Ù…Ø­ØµÙˆÙ„
        detailContainer.style.display = 'block';
        
        // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§
        addProductEventListeners();
        
        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª Ù…Ø±ØªØ¨Ø·
        loadRelatedProducts(product.category, product._id);
    }
    
    /**
     * Ø¯Ø±ÛŒØ§ÙØª ØªØµÙˆÛŒØ± Ø§ØµÙ„ÛŒ Ù…Ø­ØµÙˆÙ„
     */
    function getProductImage(product) {
        if (product.images && product.images.length > 0) {
            return product.images[0];
        }
        return '../assets/Photo/placeholder.jpg';
    }
    
    /**
     * Ø§ÛŒØ¬Ø§Ø¯ Ú¯Ø§Ù„Ø±ÛŒ ØªØµØ§ÙˆÛŒØ± Ú©ÙˆÚ†Ú©
     */
    function getGalleryThumbnails(product) {
        if (!product.images || product.images.length <= 1) {
            return '';
        }
        
        return `
            <div class="thumbnails">
                ${product.images.map((image, index) => `
                    <div class="thumbnail ${index === 0 ? 'active' : ''}">
                        <img src="${image}" alt="${product.name} - ØªØµÙˆÛŒØ± ${index + 1}" 
                            data-src="${image}" onclick="changeMainImage(this)">
                    </div>
                `).join('')}
            </div>
        `;
    }
    
    /**
     * ØªØºÛŒÛŒØ± ØªØµÙˆÛŒØ± Ø§ØµÙ„ÛŒ Ø¨Ø§ Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ ØªØµØ§ÙˆÛŒØ± Ú©ÙˆÚ†Ú©
     */
    function changeMainImage(thumbnail) {
        // ØªØºÛŒÛŒØ± ØªØµÙˆÛŒØ± Ø§ØµÙ„ÛŒ
        document.getElementById('mainProductImage').src = thumbnail.getAttribute('data-src');
        
        // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ú©Ù„Ø§Ø³ active
        document.querySelectorAll('.thumbnail').forEach(thumb => {
            thumb.classList.remove('active');
        });
        thumbnail.parentElement.classList.add('active');
    }
    
    /**
     * Ø§ÛŒØ¬Ø§Ø¯ Ø¨Ø®Ø´ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ø­ØµÙˆÙ„
     */
    function getProductFeatures(product) {
        if (!product.features || product.features.length === 0) {
            return '';
        }
        
        return `
            <div class="product-features">
                <h3>ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§</h3>
                <ul>
                    ${product.features.map(feature => `<li>${feature}</li>`).join('')}
                </ul>
            </div>
        `;
    }
    
    /**
     * Ø§ÛŒØ¬Ø§Ø¯ Ø¨Ø®Ø´ Ø§Ø¨Ø¹Ø§Ø¯ Ù…Ø­ØµÙˆÙ„
     */
    function getProductDimensions(product) {
        if (!product.dimensions) {
            return '';
        }
        
        return `
            <div class="product-dimensions">
                <h3>Ø§Ø¨Ø¹Ø§Ø¯</h3>
                <div class="dimensions-info">
                    ${product.dimensions.width ? `<span>Ø¹Ø±Ø¶: ${product.dimensions.width} Ø³Ø§Ù†ØªÛŒâ€ŒÙ…ØªØ±</span>` : ''}
                    ${product.dimensions.height ? `<span>Ø§Ø±ØªÙØ§Ø¹: ${product.dimensions.height} Ø³Ø§Ù†ØªÛŒâ€ŒÙ…ØªØ±</span>` : ''}
                    ${product.dimensions.depth ? `<span>Ø¹Ù…Ù‚: ${product.dimensions.depth} Ø³Ø§Ù†ØªÛŒâ€ŒÙ…ØªØ±</span>` : ''}
                </div>
            </div>
        `;
    }
    
    /**
     * Ø§ÛŒØ¬Ø§Ø¯ Ø¨Ø®Ø´ Ø±Ù†Ú¯â€ŒÙ‡Ø§ÛŒ Ù…Ø­ØµÙˆÙ„
     */
    function getProductColors(product) {
        if (!product.colors || product.colors.length === 0) {
            return '';
        }
        
        return `
            <div class="product-colors-section">
                <h3>Ø±Ù†Ú¯â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯</h3>
                <div class="color-options">
                    ${product.colors.map(color => `
                        <div class="color-option" style="background-color: ${color}" title="${color}"></div>
                    `).join('')}
                </div>
            </div>
        `;
    }
    
    /**
     * Ø§ÛŒØ¬Ø§Ø¯ Ø¨Ø®Ø´ Ù…ÙˆØ§Ø¯ Ø³Ø§Ø²Ù†Ø¯Ù‡ Ù…Ø­ØµÙˆÙ„
     */
    function getProductMaterials(product) {
        if (!product.materials || product.materials.length === 0) {
            return '';
        }
        
        return `
            <div class="product-materials">
                <h3>Ù…ÙˆØ§Ø¯ Ø³Ø§Ø²Ù†Ø¯Ù‡</h3>
                <div class="materials-info">
                    ${product.materials.map(material => `<span>${material}</span>`).join('')}
                </div>
            </div>
        `;
    }
    
    /**
     * Ø¯Ø±ÛŒØ§ÙØª Ù†Ø§Ù… ÙØ§Ø±Ø³ÛŒ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ
     */
    function getCategoryName(category) {
        const categories = {
            'cabinet': 'Ú©Ø§Ø¨ÛŒÙ†Øª',
            'accessories': 'Ù„ÙˆØ§Ø²Ù… Ø¬Ø§Ù†Ø¨ÛŒ',
            'hardware': 'ÛŒØ±Ø§Ù‚â€ŒØ¢Ù„Ø§Øª',
            'sink': 'Ø³ÛŒÙ†Ú©',
            'closet': 'Ú©Ù…Ø¯',
            'drawer': 'Ú©Ø´Ùˆ',
            'shelf': 'Ù‚ÙØ³Ù‡'
        };
        
        return categories[category] || category;
    }
    
    /**
     * ÙØ±Ù…Øª Ù‚ÛŒÙ…Øª Ø¨Ø§ Ø¬Ø¯Ø§Ú©Ù†Ù†Ø¯Ù‡ Ù‡Ø²Ø§Ø±Ú¯Ø§Ù†
     */
    function formatPrice(price) {
        return price.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }
    
    /**
     * Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª Ù…Ø±ØªØ¨Ø·
     */
    function loadRelatedProducts(category, currentProductId) {
        const relatedContainer = document.querySelector('.related-products-container');
        
        fetch(`http://localhost:3000/api/products?category=${category}&limit=4`)
            .then(response => response.json())
            .then(result => {
                if (!result.success || !result.data) {
                    throw new Error('Ø¯Ø§Ø¯Ù‡ Ù…Ø­ØµÙˆÙ„Ø§Øª Ù…Ø±ØªØ¨Ø· Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª');
                }
                
                // ÙÛŒÙ„ØªØ± Ú©Ø±Ø¯Ù† Ù…Ø­ØµÙˆÙ„ ÙØ¹Ù„ÛŒ Ø§Ø² Ù„ÛŒØ³Øª
                const relatedProducts = result.data.filter(p => p._id !== currentProductId);
                
                if (relatedProducts.length === 0) {
                    relatedContainer.innerHTML = '<p>Ù…Ø­ØµÙˆÙ„ Ù…Ø±ØªØ¨Ø·ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯.</p>';
                    return;
                }
                
                // Ù†Ù…Ø§ÛŒØ´ Ù…Ø­ØµÙˆÙ„Ø§Øª Ù…Ø±ØªØ¨Ø·
                relatedContainer.innerHTML = `
                    <div class="related-products-grid">
                        ${relatedProducts.slice(0, 3).map(product => `
                            <div class="related-product-card">
                                <div class="related-product-image">
                                    <img src="${product.images && product.images.length > 0 ? product.images[0] : '../assets/Photo/placeholder.jpg'}" 
                                        alt="${product.name}" loading="lazy">
                                </div>
                                <div class="related-product-details">
                                    <h3>${product.name}</h3>
                                    <div class="related-product-price">${formatPrice(product.price)} ØªÙˆÙ…Ø§Ù†</div>
                                    <a href="product.html?id=${product._id}" class="btn btn-sm">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù…Ø­ØµÙˆÙ„</a>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            })
            .catch(error => {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª Ù…Ø±ØªØ¨Ø·:', error);
                relatedContainer.innerHTML = '<p>Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª Ù…Ø±ØªØ¨Ø·</p>';
            });
    }
    
    /**
     * Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ Ø¨Ù‡ Ø§Ù„Ù…Ø§Ù†â€ŒÙ‡Ø§ÛŒ ØµÙØ­Ù‡
     */
    function addProductEventListeners() {
        // Ø±ÙˆÛŒØ¯Ø§Ø¯ ØªØ¨â€ŒÙ‡Ø§
        document.querySelectorAll('.tab-btn').forEach(button => {
            button.addEventListener('click', function() {
                // Ø­Ø°Ù Ú©Ù„Ø§Ø³ active Ø§Ø² Ù‡Ù…Ù‡ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ú©Ù„Ø§Ø³ active Ø¨Ù‡ Ø¯Ú©Ù…Ù‡ Ú©Ù„ÛŒÚ© Ø´Ø¯Ù‡
                this.classList.add('active');
                
                // Ù†Ù…Ø§ÛŒØ´ Ù…Ø­ØªÙˆØ§ÛŒ ØªØ¨ Ù…Ø±ØªØ¨Ø·
                const tabId = this.getAttribute('data-tab');
                document.querySelectorAll('.tab-pane').forEach(tab => {
                    tab.classList.remove('active');
                });
                document.getElementById(tabId).classList.add('active');
            });
        });
        
        // Ø±ÙˆÛŒØ¯Ø§Ø¯ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø§ÙØ²Ø§ÛŒØ´ Ùˆ Ú©Ø§Ù‡Ø´ ØªØ¹Ø¯Ø§Ø¯
        const quantityInput = document.getElementById('productQuantity');
        const decreaseBtn = document.querySelector('.quantity-decrease');
        const increaseBtn = document.querySelector('.quantity-increase');
        
        if (decreaseBtn && increaseBtn && quantityInput) {
            decreaseBtn.addEventListener('click', function() {
                if (quantityInput.value > 1) {
                    quantityInput.value = parseInt(quantityInput.value) - 1;
                }
            });
            
            increaseBtn.addEventListener('click', function() {
                if (parseInt(quantityInput.value) < 10) {
                    quantityInput.value = parseInt(quantityInput.value) + 1;
                }
            });
            
            // Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ÙˆØ±ÙˆØ¯ÛŒ ØªØ¹Ø¯Ø§Ø¯
            quantityInput.addEventListener('change', function() {
                const value = parseInt(this.value);
                if (isNaN(value) || value < 1) {
                    this.value = 1;
                } else if (value > 10) {
                    this.value = 10;
                }
            });
        }
        
        // Ø±ÙˆÛŒØ¯Ø§Ø¯ Ø¯Ú©Ù…Ù‡ Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯
        const addToCartBtn = document.querySelector('.add-to-cart-btn');
        if (addToCartBtn && productData) {
            addToCartBtn.addEventListener('click', function() {
                if (!productData.inStock) return;
                
                const quantity = parseInt(document.getElementById('productQuantity').value);
                
                // Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ú©Ù„Ø§Ø³ OrderManager
                if (window.orderManager) {
                    window.orderManager.addToCart({
                        id: productData._id,
                        name: productData.name,
                        type: productData.category,
                        price: productData.price,
                        quantity: quantity
                    });
                } else {
                    // Ù¾Ø´ØªÛŒØ¨Ø§Ù† Ø¨Ø±Ø§ÛŒ Ø²Ù…Ø§Ù†ÛŒ Ú©Ù‡ OrderManager Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª
                    alert(`${quantity} Ø¹Ø¯Ø¯ ${productData.name} Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯`);
                }
            });
        }
    }
    </script>
</body>
</html> 